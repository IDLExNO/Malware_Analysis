import yara

def check_file_with_yara(file_path, yara_rule_path):
    try:
        # Compile the YARA rule
        rules = yara.compile(filepath=yara_rule_path)
        # Calculate SHA-256 hash of the file
        sha256_hash = calculate_sha256(file_path)
        if sha256_hash:
            # Check if the hash matches the YARA rule
            matches = rules.match(data=sha256_hash)
            return matches
        else:
            return None
    except Exception as e:
        return str(e)

# Example usage
file_path = "sample.exe"
yara_rule_path = "fake.yar"
result = check_file_with_yara(file_path, yara_rule_path)

if result:
    print(f"File {file_path} matches the Malware in YARA rule.")
else:
    print(f"File {file_path} does not match the Malware in YARA rule.")